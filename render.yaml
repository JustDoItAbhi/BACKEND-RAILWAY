services:
  - type: web
    name: userservice-app  # MUST be lowercase, no spaces, unique name
    env: java
    region: oregon  # or singapore, frankfurt, etc.
    branch: main
    plan: free
    buildCommand: |
      # Fix mvnw permissions and build
      chmod +x ./mvnw
      ./mvnw clean package -DskipTests
    startCommand: java -Dserver.port=$PORT -jar target/*.jar
    envVars:
      - key: JAVA_VERSION
        value: "17"
      - key: SPRING_PROFILES_ACTIVE
        value: production
      - key: JAVA_OPTS
        value: -Xmx512m -Xms256m
    healthCheckPath: /actuator/health
    autoDeploy: true